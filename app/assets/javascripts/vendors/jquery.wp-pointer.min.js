/**
 * Pointer jQuery widget.
 */(function(e){var t=0,n=9999;e.widget("wp.pointer",{options:{pointerClass:"wp-pointer",pointerWidth:320,content:function(t,n,r){return e(this).text()},buttons:function(t,n){var r="Dismiss",i=e('<a class="close" href="#">'+r+"</a>");return i.bind("click.pointer",function(e){e.preventDefault();n.element.pointer("close")})},position:"top",show:function(e,t){t.pointer.show();t.opened()},hide:function(e,t){t.pointer.hide();t.closed()},document:document},_create:function(){var n,r;this.content=e('<div class="wp-pointer-content"></div>');this.arrow=e('<div class="wp-pointer-arrow"><div class="wp-pointer-arrow-inner"></div></div>');r=this.element.parents().add(this.element);n="absolute";r.filter(function(){return"fixed"===e(this).css("position")}).length&&(n="fixed");this.pointer=e("<div />").append(this.content).append(this.arrow).attr("id","wp-pointer-"+t++).addClass(this.options.pointerClass).css({position:n,width:this.options.pointerWidth+"px",display:"none"}).appendTo(this.options.document.body)},_setOption:function(t,n){var r=this.options,i=this.pointer;t==="document"&&n!==r.document?i.detach().appendTo(n.body):t==="pointerClass"&&i.removeClass(r.pointerClass).addClass(n);e.Widget.prototype._setOption.apply(this,arguments);t==="position"?this.reposition():t==="content"&&this.active&&this.update()},destroy:function(){this.pointer.remove();e.Widget.prototype.destroy.call(this)},widget:function(){return this.pointer},update:function(t){var n=this,r=this.options,i=e.Deferred(),s;if(r.disabled)return;i.done(function(e){n._update(t,e)});typeof r.content=="string"?s=r.content:s=r.content.call(this.element[0],i.resolve,t,this._handoff());s&&i.resolve(s);return i.promise()},_update:function(e,t){var n,r=this.options;if(!t)return;this.pointer.stop();this.content.html(t);n=r.buttons.call(this.element[0],e,this._handoff());n&&n.wrap('<div class="wp-pointer-buttons" />').parent().appendTo(this.content);this.reposition()},reposition:function(){var t;if(this.options.disabled)return;t=this._processPosition(this.options.position);this.pointer.css({top:0,left:0,zIndex:n++}).show().position(e.extend({of:this.element,collision:"fit none"},t));this.repoint()},repoint:function(){var e=this.options,t;if(e.disabled)return;t=typeof e.position=="string"?e.position:e.position.edge;this.pointer[0].className=this.pointer[0].className.replace(/wp-pointer-[^\s'"]*/,"");this.pointer.addClass("wp-pointer-"+t)},_processPosition:function(t){var n={top:"bottom",bottom:"top",left:"right",right:"left"},r;typeof t=="string"?r={edge:t+""}:r=e.extend({},t);if(!r.edge)return r;if(r.edge=="top"||r.edge=="bottom"){r.align=r.align||"left";r.at=r.at||r.align+" "+n[r.edge];r.my=r.my||r.align+" "+r.edge}else{r.align=r.align||"top";r.at=r.at||n[r.edge]+" "+r.align;r.my=r.my||r.edge+" "+r.align}return r},open:function(e){var t=this,n=this.options;if(this.active||n.disabled||this.element.is(":hidden"))return;this.update().done(function(){t._open(e)})},_open:function(e){var t=this,n=this.options;if(this.active||n.disabled||this.element.is(":hidden"))return;this.active=!0;this._trigger("open",e,this._handoff());this._trigger("show",e,this._handoff({opened:function(){t._trigger("opened",e,t._handoff())}}))},close:function(e){if(!this.active||this.options.disabled)return;var t=this;this.active=!1;this._trigger("close",e,this._handoff());this._trigger("hide",e,this._handoff({closed:function(){t._trigger("closed",e,t._handoff())}}))},sendToTop:function(e){this.active&&this.pointer.css("z-index",n++)},toggle:function(e){this.pointer.is(":hidden")?this.open(e):this.close(e)},_handoff:function(t){return e.extend({pointer:this.pointer,element:this.element},t)}})})(jQuery);